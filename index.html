<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cricket Scorer ‚Äì Ultimate Improved</title>

<style>
.scorer{color:#00ffcc;font-size:14px;margin-top:10px;font-weight:bold}
body{background:#0e3d1a;color:white;font-family:Arial;text-align:center}
.box{background:black;max-width:520px;margin:auto;padding:15px;border:3px solid gold;border-radius:10px}
.score{font-size:48px;color:gold;font-weight:bold}
button{padding:10px;margin:4px;font-size:15px;font-weight:bold}
.run{background:#eee}
.wide{background:orange}
.wicket{background:red;color:white}
.undo{background:gray;color:white}
.section{background:#111;padding:8px;margin-top:8px;text-align:left;font-size:14px}
.strike{color:gold;font-weight:bold}
.out{color:#ff3333;font-weight:bold}
.target{color:#00ffcc;font-weight:bold}
.rrr{color:#ffd700;font-weight:bold}
.four{background:#1e90ff;color:white}
.six{background:#32cd32;color:black}

/* section heading green */
.section b{color:#00ff66}

/* win ui */
#winTag{color:#00ff66;font-weight:bold;margin-left:6px}
#winnerBoard{color:#00ff66;font-size:20px;font-weight:bold;margin-top:6px}
.strikeBat{
  color: gold;
  font-weight: bold;
}
.strikeIcon{
  color: gold;
  margin-right: 5px;
}
/* OUT batsman red color */
.outBat {
  color: #ff3333;
  font-weight: bold;
}

/* optional cross mark */
.outBat::after {
  content: " ‚úñ";
  color: #ff3333;
}
</style>
</head>

<body>

<div class="box">

<h3>
 <span id="team"></span>
 <span id="winTag" style="display:none">üèÜ WIN</span>
</h3>

<div id="inningInfo"></div>

<div class="score">
<span id="runs">0</span>/<span id="wickets">0</span>
</div>

<div id="winnerBoard" style="display:none"></div>

<div>
Overs: <span id="overs">0.0</span> |
Balls: <span id="balls">0</span>/<span id="totalBalls"></span>
</div>

<div id="target" class="target"></div>
<div id="rrr" class="rrr"></div>

<div class="section">
<b>Current Batsmen</b>
<div id="current"></div>
</div>

<div>
<button class="run" onclick="play(0)">0</button>
<button class="run" onclick="play(1)">1</button>
<button class="run" onclick="play(2)">2</button>
<button class="run" onclick="play(3)">3</button>
<button class="run four" onclick="play(4)">4</button>
<button class="run six" onclick="play(6)">6</button><br>
<button class="wide" onclick="extra()">WD / NB</button>
<button class="wicket" onclick="wicket()">WICKET</button>
<button class="undo" onclick="undo()">UNDO</button>
</div>

<div class="section">
<b>Batting Scorecard</b>
<div id="scorecard"></div>
</div>

<div class="section">
<b>Bowling Scorecard</b>
<div id="bowling"></div>
</div>

<div class="section">
<b>üìòBatting Record</b>
<div id="firstBat"></div>
</div>

<div class="section">
<b>üìòBowling Record</b>
<div id="firstBowl"></div>
</div>

</div>

<div class="scorer">Scorer : Shahin Qumar</div>

<script>
const teamEl=document.getElementById("team"),
runsEl=document.getElementById("runs"),
wicketsEl=document.getElementById("wickets"),
ballsEl=document.getElementById("balls"),
oversEl=document.getElementById("overs"),
currentEl=document.getElementById("current"),
scorecardEl=document.getElementById("scorecard"),
bowlingEl=document.getElementById("bowling"),
targetEl=document.getElementById("target"),
rrrEl=document.getElementById("rrr"),
inningInfo=document.getElementById("inningInfo"),
totalBallsEl=document.getElementById("totalBalls"),
winTag=document.getElementById("winTag"),
winnerBoard=document.getElementById("winnerBoard");

let team1=prompt("Team 1 Name")||"Team A";
let team2=prompt("Team 2 Name")||"Team B";

let totalOvers=parseInt(prompt("Overs?"))||6;
let totalBalls=totalOvers*6;
totalBallsEl.innerText=totalBalls;

let innings=1,target=0;
let runs=0,wickets=0,balls=0;
let batsmen=[],bowlers=[];
let striker=0,nonStriker=0;
let currentBowler=null;
let undoStack=[];
let firstBatting=[],firstBowling=[];
let matchOver=false;

/* ---- EXISTING LOGIC (UNCHANGED) ---- */

function cloneState(){
 return JSON.parse(JSON.stringify({
  innings,target,runs,wickets,balls,
  batsmen,bowlers,striker,nonStriker,
  bowlerName:currentBowler?.name,
  firstBatting,firstBowling,matchOver
 }));
}
function restoreState(s){
 innings=s.innings;target=s.target;
 runs=s.runs;wickets=s.wickets;balls=s.balls;
 batsmen=s.batsmen;bowlers=s.bowlers;
 striker=s.striker;nonStriker=s.nonStriker;
 firstBatting=s.firstBatting;firstBowling=s.firstBowling;
 matchOver=s.matchOver;
 currentBowler=bowlers.find(b=>b.name===s.bowlerName)||null;
}
function save(){undoStack.push(cloneState());}

function newBatsman(){
 return {name:prompt("Batsman Name")||"Player",runs:0,balls:0,out:false};
}
function newBowler(){
 let name=prompt("Bowler Name")||"Bowler";
 let exist=bowlers.find(b=>b.name===name);
 if(exist){currentBowler=exist;return;}
 let b={name,balls:0,runs:0,wickets:0};
 bowlers.push(b);currentBowler=b;
}

function resetInnings(){
 runs=wickets=balls=0;
 batsmen=[];bowlers=[];
 striker=0;nonStriker=1;
 matchOver=false;
 winTag.style.display="none";
 winnerBoard.style.display="none";
 batsmen.push(newBatsman(),newBatsman());
 newBowler();
}

function update(){
 teamEl.innerText=(innings===1?team1:team2);
 inningInfo.innerText="Innings: "+innings;
 runsEl.innerText=runs;wicketsEl.innerText=wickets;
 ballsEl.innerText=balls;
 oversEl.innerText=Math.floor(balls/6)+"."+(balls%6);
 currentEl.innerHTML =
 `<div class="${batsmen[striker].out ? "out" : "strikeBat"}">
   <span class="strikeIcon">‚òÖ</span>
   ${batsmen[striker].name} - ${batsmen[striker].runs}(${batsmen[striker].balls})
 </div>
 <div class="${batsmen[nonStriker].out ? "out" : ""}">
   ${batsmen[nonStriker].name} - ${batsmen[nonStriker].runs}(${batsmen[nonStriker].balls})
 </div>`; 
 renderBatting();renderBowling();updateRRR();
}

function showWin(team){
 winTag.style.display="inline";
 winnerBoard.innerText=team+" WON THE MATCH";
 winnerBoard.style.display="block";
}

function play(r){
 if(matchOver)return;
 save();
 runs+=r;balls++;
 batsmen[striker].runs+=r;
 batsmen[striker].balls++;
 currentBowler.runs+=r;
 currentBowler.balls++;
 if(r%2)changeStrike();
 endBall();
}

function extra(){
 if(matchOver) return;
 save();
 runs++;                  // extra run
 currentBowler.runs++;    // bowler run
 update();                // ‡§∏‡§ø‡§∞‡•ç‡§´ update
}

function wicket(){
 if(matchOver)return;
 save();
 balls++;wickets++;
 batsmen[striker].balls++;
 batsmen[striker].out=true;
 currentBowler.wickets++;
 currentBowler.balls++;
 batsmen.push(newBatsman());
 striker=batsmen.length-1;
 endBall();
}

function changeStrike(){[striker,nonStriker]=[nonStriker,striker];}

function endBall(){
 if(innings===2 && runs>=target && !matchOver){
  matchOver=true;
  alert(team2+" WON");
  showWin(team2);
  update();return;
 }
 if(balls%6===0 && balls<totalBalls){
  changeStrike();newBowler();
 }
 if(balls===totalBalls || wickets===10){
  if(innings===1){
   firstBatting=JSON.parse(JSON.stringify(batsmen));
   firstBowling=JSON.parse(JSON.stringify(bowlers));
   renderFirst();
   target=runs+1;
   alert("Target: "+target);
   innings=2;resetInnings();
  }else if(!matchOver){
   matchOver=true;
   alert(team1+" WON");
   showWin(team1);
  }
 }
 update();
}

function renderBatting(){
 scorecardEl.innerHTML="";
 batsmen.forEach((b,i)=>{
scorecardEl.innerHTML+=`
<span class="${b.out ? 'outBat' : ''}">
${i+1}. ${b.name} - ${b.runs}(${b.balls}) ${b.out ? 'OUT' : 'NOT OUT'}
</span><br>`;
 });
}
function renderBowling(){
 bowlingEl.innerHTML="";
 bowlers.forEach((b,i)=>{
  bowlingEl.innerHTML+=`${i+1}. ${b.name} ‚Äì ${Math.floor(b.balls/6)}.${b.balls%6} overs | ${b.runs} runs | ${b.wickets} wkts<br>`;
 });
}
function renderFirst(){
 firstBat.innerHTML="";firstBowl.innerHTML="";
 firstBatting.forEach((b,i)=>{
  firstBat.innerHTML+=`${i+1}. ${b.name} ‚Äì ${b.runs}(${b.balls}) ${b.out?"OUT":"NOT OUT"}<br>`;
 });
 firstBowling.forEach((b,i)=>{
  firstBowl.innerHTML+=`${i+1}. ${b.name} ‚Äì ${Math.floor(b.balls/6)}.${b.balls%6} overs | ${b.runs} runs | ${b.wickets} wkts<br>`;
 });
}
function updateRRR(){
 if(innings===2 && !matchOver){
  let bl=totalBalls-balls,rl=target-runs;
  if(bl>0&&rl>0)
   rrrEl.innerHTML=`Need ${rl} runs in ${bl} balls | RRR: ${((rl/bl)*6).toFixed(2)}`;
 }
}
function undo(){
 if(!undoStack.length)return;
 restoreState(undoStack.pop());update();
}

resetInnings();update();
</script>

</body>
</html>
