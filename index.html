<!DOCTYPE html>
<html lang="hi">
<head>
    <meta name="google-site-verification" content="M4Jo-fK6gqv_xRdWJqwokRSkgBDA8M6kwsgn-Kc2KBk" />
    <meta charset="UTF-8">
    <title>Advanced Cricket Scorer - Ball by Ball</title>
    <style>
        :root { --field-green: #0e3d1a; --scoreboard-black: #000000; --gold: #ffd700; --white: #ffffff; }
        body { font-family: 'Arial', sans-serif; background: var(--field-green); color: var(--white); text-align: center; padding: 10px; }
        .box { background: var(--scoreboard-black); border: 4px solid var(--gold); border-radius: 15px; max-width: 480px; margin: auto; padding: 20px; box-shadow: 0 0 30px rgba(0,0,0,0.8); }
        .screen { display: none; }
        .active { display: block; }
        
        /* Stats Bar */
        .stats-bar { display: flex; justify-content: space-around; background: #1a1a1a; padding: 10px; border-radius: 5px; margin: 15px 0; border-bottom: 2px solid var(--gold); }
        .stat-val { display: block; color: var(--gold); font-size: 18px; font-weight: bold; }

        .score-display { font-size: 75px; font-weight: 900; color: var(--gold); margin: 5px 0; letter-spacing: -2px; }
        .team-banner { font-size: 22px; background: var(--gold); color: black; padding: 8px; border-radius: 4px; font-weight: bold; width: 100%; box-sizing: border-box; }
        
        /* Ball Tracker */
        .ball-tracker { background: #222; padding: 10px; border-radius: 5px; margin: 15px 0; text-align: left; overflow-x: auto; white-space: nowrap; }
        .ball-circle { display: inline-block; width: 30px; height: 30px; line-height: 30px; border-radius: 50%; background: #444; text-align: center; margin-right: 5px; font-weight: bold; font-size: 14px; }
        .ball-w { background: #d32f2f; }
        .ball-6 { background: #1e88e5; }
        .ball-4 { background: #43a047; }
        .ball-ex { background: #fb8c00; }

        .btn-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px; }
        button { padding: 15px 5px; cursor: pointer; border-radius: 5px; border: none; font-weight: bold; font-size: 16px; }
        .btn-run { background: #eee; color: #000; }
        .btn-extra { background: #fb8c00; color: white; }
        .btn-wkt { background: #d32f2f; color: white; grid-column: span 2; }
        .btn-toss { background: var(--gold); color: black; width: 100%; height: 60px; font-size: 22px; margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>

<div class="box">
    <div id="tossScreen" class="screen active">
        <h2 style="color:var(--gold)">Jahajkitta vs Resamba</h2>
        <p>WHO WON THE TOSS?</p>
        <button class="btn-toss" onclick="setToss('Jahajkitta')">Jahajkitta</button>
        <button class="btn-toss" onclick="setToss('Resamba')" style="background:#444; color:white;">Resamba</button>
    </div>

    <div id="mainScreen" class="screen">
        <div id="inningTag" style="color:#00ff00; font-size:14px; margin-bottom:5px;">FIRST INNINGS</div>
        <div id="battingTeamTitle" class="team-banner">TEAM NAME</div>

        <div class="score-display"><span id="totalRuns">0</span>-<span id="totalWkts">0</span></div>

        <div class="stats-bar">
            <div>OVERS<span id="overCount" class="stat-val">0.0</span></div>
            <div>CRR<span id="crr" class="stat-val">0.00</span></div>
            <div id="reqDiv" style="display:none;">RRR<span id="rrr" class="stat-val">0.00</span></div>
        </div>

        <div id="targetDisplay" style="color:var(--gold); font-size:16px; margin-bottom:10px;">Target: -</div>

        <div style="text-align:left; font-size:12px; color:#aaa; margin-left:5px;">THIS OVER:</div>
        <div class="ball-tracker" id="ballTracker">
            </div>

        <div class="btn-grid">
            <button class="btn-run" onclick="record(0)">0</button>
            <button class="btn-run" onclick="record(1)">1</button>
            <button class="btn-run" onclick="record(2)">2</button>
            <button class="btn-run" onclick="record(3)">3</button>
            <button class="btn-run" onclick="record(4)" style="border: 2px solid green;">4</button>
            <button class="btn-run" onclick="record(6)" style="border: 2px solid blue;">6</button>
            <button class="btn-extra" onclick="record('WD')">WD</button>
            <button class="btn-extra" onclick="record('NB')">NB</button>
            <button class="btn-wkt" onclick="record('W')">WICKET</button>
            <button onclick="undo()" style="background:#555; color:white; grid-column: span 2;">UNDO</button>
        </div>
    </div>

    <div id="resultScreen" class="screen">
        <h1 style="color:var(--gold)">MATCH OVER</h1>
        <h2 id="winnerText"></h2>
        <button class="btn-toss" onclick="location.reload()">REPLAY</button>
    </div>
</div>

<script>
    let teamA = "Jahajkitta", teamB = "Resamba";
    let battingTeam = "", bowlingTeam = "";
    let runs = 0, wkts = 0, balls = 0, inning = 1, target = 0;
    let history = []; // To track all actions for Undo

    function setToss(winner) {
        battingTeam = winner;
        bowlingTeam = (winner === teamA) ? teamB : teamA;
        document.getElementById('tossScreen').classList.remove('active');
        document.getElementById('mainScreen').classList.add('active');
        updateUI();
    }

    function record(val) {
        history.push({val, runs, wkts, balls, inning}); // Store for undo
        
        if (val === 'W') {
            wkts++;
            balls++;
        } else if (val === 'WD' || val === 'NB') {
            runs += 1;
        } else {
            runs += val;
            balls++;
        }

        addBallToTracker(val);
        updateUI();
        checkStatus();
    }

    function addBallToTracker(val) {
        const tracker = document.getElementById('ballTracker');
        const span = document.createElement('span');
        span.className = 'ball-circle';
        if (val === 'W') span.classList.add('ball-w');
        if (val === 4) span.classList.add('ball-4');
        if (val === 6) span.classList.add('ball-6');
        if (val === 'WD' || val === 'NB') span.classList.add('ball-ex');
        span.innerText = val;
        tracker.appendChild(span);
    }

    function undo() {
        if (history.length === 0) return;
        let last = history.pop();
        runs = last.runs;
        wkts = last.wkts;
        balls = last.balls;
        inning = last.inning;
        
        const tracker = document.getElementById('ballTracker');
        if (tracker.lastChild) tracker.removeChild(tracker.lastChild);
        updateUI();
    }

    function updateUI() {
        document.getElementById('totalRuns').innerText = runs;
        document.getElementById('totalWkts').innerText = wkts;
        document.getElementById('battingTeamTitle').innerText = battingTeam.toUpperCase();
        
        let ov = Math.floor(balls / 6) + "." + (balls % 6);
        document.getElementById('overCount').innerText = ov;

        let totalOvers = (Math.floor(balls / 6) + (balls % 6) / 6) || 0;
        let crr = totalOvers > 0 ? (runs / totalOvers).toFixed(2) : "0.00";
        document.getElementById('crr').innerText = crr;

        if (inning === 2) {
            document.getElementById('reqDiv').style.display = "block";
            document.getElementById('targetDisplay').innerText = "Target: " + target + " | Needed: " + (target - runs) + " from " + (36 - balls) + " balls";
            let remainingBalls = 36 - balls;
            let rrr = remainingBalls > 0 ? ((target - runs) / (remainingBalls / 6)).toFixed(2) : "0.00";
            document.getElementById('rrr').innerText = rrr;
        }
    }

    function checkStatus() {
        if ((inning === 2 && runs >= target) || wkts >= 10 || balls >= 36) {
            if (inning === 1) {
                target = runs + 1;
                alert("Inning Over! " + bowlingTeam + " needs " + target + " runs.");
                inning = 2;
                let temp = battingTeam; battingTeam = bowlingTeam; bowlingTeam = temp;
                runs = 0; wkts = 0; balls = 0;
                document.getElementById('inningTag').innerText = "SECOND INNINGS";
                document.getElementById('ballTracker').innerHTML = ""; // Clear for 2nd inning
                updateUI();
            } else {
                showResult();
            }
        }
    }

    function showResult() {
        document.getElementById('mainScreen').classList.remove('active');
        document.getElementById('resultScreen').classList.add('active');
        let msg = (runs >= target) ? battingTeam + " WON! üéâ" : bowlingTeam + " WON! üéâ";
        if (runs === target - 1) msg = "MATCH TIED! ü§ù";
        document.getElementById('winnerText').innerText = msg.toUpperCase();
    }
</script>

</body>
</html>
