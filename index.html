<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cricket Scorer ‚Äì Ultimate Improved</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
.scorer{color:#00ffcc;font-size:14px;margin-top:10px;font-weight:bold}
body{
  background:#ffffff;
  color:#000;
  font-family:Arial;
  text-align:center;
}

.box{
  width:100vw;        /* pura viewport width */
  max-width:100vw;   /* koi limit nahi */
  margin:0;          /* gap khatam */
  padding:16px;
  border:3px solid #c62828;
  border-radius:0;   /* edge to edge */
  box-sizing:border-box;
}
/* SCORE */
.score{
  font-size:48px;
  color:#f9a825;
  font-weight:bold;
}

/* SECTIONS */
.section{
  background:#f5f5f5;
  padding:8px;
  margin-top:8px;
  text-align:left;
  font-size:14px;
  border:1px solid #ddd;
}

/* Section heading */
.section b{
  color:#c62828;
}

/* Buttons */
button{
  padding:10px;
  margin:4px;
  font-size:15px;
  font-weight:bold;
  border-radius:4px;
  border:1px solid #999;
}

.run{background:#eeeeee}
.wide{background:#ffb300}
.wicket{background:#d32f2f;color:white}
.undo{background:#9e9e9e;color:white}
.four{background:#1976d2;color:white}
.six{background:#43a047;color:white}

/* Current batsman */
.strikeBat{
  color: green;
  font-weight:bold;
}

.strikeIcon{
  color:#f9a825;
}

/* OUT batsman */
.outBat{
  color:#ff7f7f;
  font-weight:bold;
}

.outBat::after{
  content:" ‚úñ";
}

/* Bowling current */
.currentBowler{
  color:green;
  font-weight:bold;
}

/* Footer */
.scorer{
  color:#00796b;
  font-size:14px;
  margin-top:10px;
  font-weight:bold;
}
@media (max-width:767px){
  .box{
    max-width:100%;
    margin:0;
    border-radius:0;
  }
}
@media (min-width:600px){
  body{
    margin:0;
  }
}
</style>
</head>

<body>

<div class="box">

<h3>
 <span id="team"></span>
 <span id="winTag" style="display:none">üèÜ WIN</span>
</h3>

<div id="inningInfo"></div>

<div class="score">
<span id="runs">0</span>/<span id="wickets">0</span>
</div>

<div id="winnerBoard" style="display:none"></div>

<div>
Overs: <span id="overs">0.0</span> |
Balls: <span id="balls">0</span>/<span id="totalBalls"></span>
</div>

<div id="target" class="target"></div>
<div id="rrr" class="rrr"></div>

<div class="section">
<b>Current Batsmen</b>
<div id="current"></div>
</div>

<div>
<button class="run" onclick="play(0)">0</button>
<button class="run" onclick="play(1)">1</button>
<button class="run" onclick="play(2)">2</button>
<button class="run" onclick="play(3)">3</button>
<button class="run four" onclick="play(4)">4</button>
<button class="run six" onclick="play(6)">6</button><br>
<button class="wide" onclick="extra()">WD / NB</button>
<button class="wicket" onclick="wicket()">WICKET</button>
<button class="undo" onclick="undo()">UNDO</button>
<button onclick="showMemories()">üìú MATCH MEMORY</button>
<button onclick="manageMemories()">üóëÔ∏è MANAGE MEMORY</button>

</div>

<div class="section">
<b>Batting Scorecard</b>
<div id="scorecard"></div>
</div>

<div class="section">
<b>Bowling Scorecard</b>
<div id="bowling"></div>
</div>

<div class="section">
<b>üìò First Innings Batting Record</b>
<div id="firstBat"></div>
</div>

<div class="section">
<b>üìò First Innings Bowling Record</b>
<div id="firstBowl"></div>
</div>

</div>

<div class="scorer">Scorer : Shahin Qumar</div>

<script>
const teamEl=document.getElementById("team"),
runsEl=document.getElementById("runs"),
wicketsEl=document.getElementById("wickets"),
ballsEl=document.getElementById("balls"),
oversEl=document.getElementById("overs"),
currentEl=document.getElementById("current"),
scorecardEl=document.getElementById("scorecard"),
bowlingEl=document.getElementById("bowling"),
targetEl=document.getElementById("target"),
rrrEl=document.getElementById("rrr"),
inningInfo=document.getElementById("inningInfo"),
totalBallsEl=document.getElementById("totalBalls"),
winTag=document.getElementById("winTag"),
winnerBoard=document.getElementById("winnerBoard");

let team1=prompt("Team 1 Name")||"Team A";
let team2=prompt("Team 2 Name")||"Team B";

let totalOvers=parseInt(prompt("Overs?"))||6;
let totalBalls=totalOvers*6;
totalBallsEl.innerText=totalBalls;

let innings=1,target=0;
let runs=0,wickets=0,balls=0;
let batsmen=[],bowlers=[];
let striker=0,nonStriker=0;
let currentBowler=null;
let undoStack=[];
let firstBatting=[],firstBowling=[];
let matchOver=false;

/* ---- EXISTING LOGIC (UNCHANGED) ---- */
function cloneState(){
 return JSON.parse(JSON.stringify({
  innings,target,runs,wickets,balls,
  batsmen,bowlers,striker,nonStriker,
  bowlerName:currentBowler?.name,
  firstBatting,firstBowling,matchOver
 }));
}
function restoreState(s){
 innings=s.innings;target=s.target;
 runs=s.runs;wickets=s.wickets;balls=s.balls;
 batsmen=s.batsmen;bowlers=s.bowlers;
 striker=s.striker;nonStriker=s.nonStriker;
 firstBatting=s.firstBatting;firstBowling=s.firstBowling;
 matchOver=s.matchOver;
 currentBowler=bowlers.find(b=>b.name===s.bowlerName)||null;
}
function save(){undoStack.push(cloneState());}

function newBatsman(){
 return {name:prompt("Batsman Name")||"Player",runs:0,balls:0,out:false};
}
function newBowler(){
 let name=prompt("Bowler Name")||"Bowler";
 let exist=bowlers.find(b=>b.name===name);
 if(exist){currentBowler=exist;return;}
 let b={
  name,
  balls:0,
  runs:0,
  wickets:0,
  wides:0,
  wicketsTaken:[]   // ‚úÖ kis batsman ko out kiya
};
 bowlers.push(b);currentBowler=b;
}

function resetInnings(){
 runs=wickets=balls=0;
 batsmen=[];bowlers=[];
 striker=0;nonStriker=1;
 matchOver=false;
 winTag.style.display="none";
 winnerBoard.style.display="none";
 batsmen.push(newBatsman(),newBatsman());
 newBowler();
}

function update(){
 teamEl.innerText=(innings===1?team1:team2);
 inningInfo.innerText="Innings: "+innings;
 runsEl.innerText=runs;wicketsEl.innerText=wickets;
 ballsEl.innerText=balls;
 oversEl.innerText=Math.floor(balls/6)+"."+(balls%6);
 currentEl.innerHTML =
 `<div class="${batsmen[striker].out ? "out" : "strikeBat"}">
   <span class="strikeIcon">‚òÖ</span>
   ${batsmen[striker].name} - ${batsmen[striker].runs}(${batsmen[striker].balls})
 </div>
 <div class="${batsmen[nonStriker].out ? "out" : ""}">
   ${batsmen[nonStriker].name} - ${batsmen[nonStriker].runs}(${batsmen[nonStriker].balls})
 </div>`; 
 renderBatting();renderBowling();updateRRR();
}

function showWin(team){
 winTag.style.display="inline";

 let winData = getWinnerSummary(team);

 winnerBoard.innerHTML = `
  ${winData.result}<br>
  <span style="font-size:14px;color:#ffd700">
   ${winData.summary}
  </span>
 `;
 winnerBoard.style.display="block";

 saveMatchMemory(winData.result + " | " + winData.summary);
}

function play(r){
 if(matchOver)return;
 save();
 runs+=r;balls++;
 batsmen[striker].runs+=r;
 batsmen[striker].balls++;
 currentBowler.runs+=r;
 currentBowler.balls++;
 
 if(r%2)changeStrike();
 endBall();
}

function extra(){
 if(matchOver) return;
 save();

 runs++;                  // team run
 currentBowler.runs++;    // bowler run
 currentBowler.wides++;   // ‚úÖ wide count

 update();
}

function wicket(){
 if(matchOver)return;
 save();

 balls++;
 wickets++;

 batsmen[striker].balls++;
 batsmen[striker].out=true;

 currentBowler.wickets++;
 currentBowler.balls++;

 // ‚úÖ WHO TOOK WHO'S WICKET
 currentBowler.wicketsTaken.push(batsmen[striker].name);

 batsmen.push(newBatsman());
 striker=batsmen.length-1;

 endBall();
}

function changeStrike(){[striker,nonStriker]=[nonStriker,striker];}

function endBall(){

  // üèÜ Team 2 wins while chasing
  if(innings === 2 && runs >= target && !matchOver){
    matchOver = true;
    showWin(team2);
    update();
    return;
  }

  // üîÅ Over change
  if(balls % 6 === 0 && balls < totalBalls){
    changeStrike();
    newBowler();
  }

  // üõë Innings / Match end
  if(balls === totalBalls || wickets === 10){

    // üëâ First innings end
    if(innings === 1){
      firstBatting = JSON.parse(JSON.stringify(batsmen));
      firstBowling = JSON.parse(JSON.stringify(bowlers));
      renderFirst();
      target = runs + 1;
      alert("Target: " + target);
      innings = 2;
      resetInnings();
    }

    // üëâ Second innings end
    else if(!matchOver){

      // ü§ù TIE
      if(runs === target - 1){
        matchOver = true;
        let oversPlayed = Math.floor(balls/6) + "." + (balls%6);
        let tieText = `MATCH TIED | Score: ${runs}/${wickets} in ${oversPlayed} overs | Target ${target-1}`;
        winnerBoard.innerHTML = tieText;
        winnerBoard.style.display = "block";
        saveMatchMemory(tieText);
        alert("MATCH TIED");
      }

      // üèÜ Team 1 wins (defending)
      else{
        matchOver = true;
        showWin(team1);
      }
    }
  }

  update();
}

function renderBatting(){
 scorecardEl.innerHTML="";
 batsmen.forEach((b,i)=>{
scorecardEl.innerHTML+=`
<span class="${b.out ? 'outBat' : ''}">
${i+1}. ${b.name} - ${b.runs}(${b.balls}) ${b.out ? 'OUT' : 'NOT OUT'}
</span><br>`;
 });
}
function renderBowling(){
 bowlingEl.innerHTML="";
 bowlers.forEach((b,i)=>{
  let cls = (currentBowler && b.name === currentBowler.name) ? "currentBowler" : "";

  let wkText = b.wicketsTaken.length
    ? ` | Wkts: ${b.wicketsTaken.join(", ")}`
    : "";

  bowlingEl.innerHTML+=`
  <span class="${cls}">
   ${i+1}. ${b.name} ‚Äì
   ${Math.floor(b.balls/6)}.${b.balls%6} overs |
   ${b.runs} runs |
   ${b.wickets} wkts |
   ${b.wides} WD
   ${wkText}
  </span><br>`;
 });
}

function renderFirst(){
 firstBat.innerHTML="";firstBowl.innerHTML="";
 firstBatting.forEach((b,i)=>{
  firstBat.innerHTML+=`${i+1}. ${b.name} ‚Äì ${b.runs}(${b.balls}) ${b.out?"OUT":"NOT OUT"}<br>`;
 });
 firstBowling.forEach((b,i)=>{
  firstBowl.innerHTML+=`${i+1}. ${b.name} ‚Äì ${Math.floor(b.balls/6)}.${b.balls%6} overs | ${b.runs} runs | ${b.wickets} wkts<br>`;
 });
}
function updateRRR(){
 if(innings===2 && !matchOver){
  let bl=totalBalls-balls,rl=target-runs;
  if(bl>0&&rl>0)
   rrrEl.innerHTML=`Need ${rl} runs in ${bl} balls | RRR: ${((rl/bl)*6).toFixed(2)}`;
 }
}
function undo(){
 if(!undoStack.length)return;
 restoreState(undoStack.pop());update();
}

resetInnings();update();
function saveMatchMemory(resultText){
  let memory = {
    date: new Date().toLocaleString(),
    team1: team1,
    team2: team2,
    overs: totalOvers,
    result: resultText,
    firstInnings: {
      team: team1,
      score: firstBatting
    },
    secondInnings: {
      team: team2,
      score: batsmen
    }
  };

  let allMatches = JSON.parse(localStorage.getItem("cricketMemories")) || [];
  allMatches.push(memory);
  localStorage.setItem("cricketMemories", JSON.stringify(allMatches));
}
function showMemories(){
 let data = JSON.parse(localStorage.getItem("cricketMemories")) || [];
 if(!data.length){
   alert("No match memories saved ‚ù§Ô∏è");
   return;
 }

 let text = "üèè MATCH MEMORIES üèè\n\n";
 data.forEach((m,i)=>{
  text += `${i+1}. ${m.date}\n${m.team1} vs ${m.team2}\nResult: ${m.result}\n\n`;
 });
 alert(text);
}
function manageMemories(){
 let data = JSON.parse(localStorage.getItem("cricketMemories")) || [];
 if(!data.length){
   alert("No match memories to delete ‚ù§Ô∏è");
   return;
 }

 let msg = "üóëÔ∏è MATCH MEMORIES (Type number to delete)\n\n";
 data.forEach((m,i)=>{
  msg += `${i+1}. ${m.date} | ${m.team1} vs ${m.team2} | ${m.result}\n`;
 });

 let del = prompt(msg + "\nEnter match number to DELETE:");
 if(!del) return;

 let index = parseInt(del) - 1;
 if(isNaN(index) || index < 0 || index >= data.length){
   alert("Invalid number ‚ùå");
   return;
 }

 if(confirm("Are you sure you want to delete this match memory?")){
   data.splice(index,1);
   localStorage.setItem("cricketMemories", JSON.stringify(data));
   alert("‚úÖ Match memory deleted");
 }
}
function getResultText(winner){
 if(innings === 2){
   // chasing team won
   let wicketsLeft = 10 - wickets;
   return `${winner} won by ${wicketsLeft} wicket${wicketsLeft>1?'s':''}`;
 }else{
   // defending team won
   let runMargin = target - 1 - runs;
   return `${winner} won by ${runMargin} run${runMargin>1?'s':''}`;
 }
}

function getWinnerSummary(winner){
 let oversPlayed = Math.floor(balls/6) + "." + (balls%6);

 if(innings === 2){
   // chasing team won
   let wicketsLeft = 10 - wickets;
   return {
     result: `${winner} won by ${wicketsLeft} wicket${wicketsLeft>1?'s':''}`,
     summary: `Score: ${runs}/${wickets} in ${oversPlayed} overs | Chased target ${target-1}`
   };
 }else{
   // defending team won
   let runMargin = target - 1 - runs;
   return {
     result: `${winner} won by ${runMargin} run${runMargin>1?'s':''}`,
     summary: `Score: ${runs}/${wickets} in ${oversPlayed} overs | Defended target ${target-1}`
   };
 }
}
function getTieSummary(){
 let oversPlayed = Math.floor(balls/6) + "." + (balls%6);
 return `MATCH TIED | Score: ${runs}/${wickets} in ${oversPlayed} overs | Target ${target-1}`;
}

</script>

</body>
</html>
